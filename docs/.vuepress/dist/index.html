<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>指南</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/freelog.ico">
    <meta name="description" content="freelog 开发者文档">
    
    <link rel="preload" href="/assets/css/0.styles.d68352bd.css" as="style"><link rel="preload" href="/assets/js/app.ee00aa5c.js" as="script"><link rel="preload" href="/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/assets/js/7.49352607.js" as="script"><link rel="prefetch" href="/assets/js/10.83d56c5b.js"><link rel="prefetch" href="/assets/js/3.dc72da58.js"><link rel="prefetch" href="/assets/js/4.0dd8aefa.js"><link rel="prefetch" href="/assets/js/5.216cae74.js"><link rel="prefetch" href="/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/assets/js/8.b1927570.js"><link rel="prefetch" href="/assets/js/9.23864325.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d68352bd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" aria-current="page" class="home-link router-link-exact-active router-link-active"><img src="/home.jpg" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  指南
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/adapt/" class="nav-link">
  技术方案适配
</a></div><div class="nav-item"><a href="/faq/" class="nav-link">
  FAQ
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  指南
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/adapt/" class="nav-link">
  技术方案适配
</a></div><div class="nav-item"><a href="/faq/" class="nav-link">
  FAQ
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/#介绍" class="sidebar-link">介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header"><a href="/#通俗解释" class="sidebar-link">通俗解释</a></li><li class="sidebar-sub-header"><a href="/#运行原理" class="sidebar-link">运行原理</a></li></ul></li><li><a href="/#示例节点代码仓" class="sidebar-link">示例节点代码仓</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#基础使用案例代码仓" class="sidebar-link">基础使用案例代码仓</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#有意思的怀旧红白机" class="sidebar-link">有意思的怀旧红白机</a></li><li class="sidebar-sub-header"><a href="/#插件改造" class="sidebar-link">插件改造</a></li></ul></li><li><a href="/#开发" class="sidebar-link">开发</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#https-证书准备-必须" class="sidebar-link">https 证书准备（必须）</a></li><li class="sidebar-sub-header"><a href="/#chrome-无法访问-localhost-问题" class="sidebar-link">chrome 无法访问 localhost 问题</a></li><li class="sidebar-sub-header"><a href="/#创建一个节点和主题" class="sidebar-link">创建一个节点和主题</a></li><li class="sidebar-sub-header"><a href="/#连接节点与插件" class="sidebar-link">连接节点与插件</a></li><li class="sidebar-sub-header"><a href="/#安装-api-库" class="sidebar-link">安装 api 库</a></li><li class="sidebar-sub-header"><a href="/#获取节点信息" class="sidebar-link">获取节点信息</a></li><li class="sidebar-sub-header"><a href="/#加载自身的子依赖插件" class="sidebar-link">加载自身的子依赖插件</a></li><li class="sidebar-sub-header"><a href="/#加载展品插件" class="sidebar-link">加载展品插件</a></li><li class="sidebar-sub-header"><a href="/#单独调试某个插件" class="sidebar-link">单独调试某个插件</a></li><li class="sidebar-sub-header"><a href="/#插件卸载" class="sidebar-link">插件卸载</a></li><li class="sidebar-sub-header"><a href="/#获取插件自身配置数据" class="sidebar-link">获取插件自身配置数据</a></li><li class="sidebar-sub-header"><a href="/#移动端适配" class="sidebar-link">移动端适配</a></li></ul></li><li><a href="/#展品相关" class="sidebar-link">展品相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#获取展品" class="sidebar-link">获取展品</a></li><li class="sidebar-sub-header"><a href="/#获取单个展品详情" class="sidebar-link">获取单个展品详情</a></li><li class="sidebar-sub-header"><a href="/#获取展品作品" class="sidebar-link">获取展品作品</a></li><li class="sidebar-sub-header"><a href="/#展品子依赖列表" class="sidebar-link">展品子依赖列表</a></li><li class="sidebar-sub-header"><a href="/#批量查询展品依赖的作品信息" class="sidebar-link">批量查询展品依赖的作品信息</a></li><li class="sidebar-sub-header"><a href="/#获取子依赖作品文件" class="sidebar-link">获取子依赖作品文件</a></li><li class="sidebar-sub-header"><a href="/#查找展品签约数量" class="sidebar-link">查找展品签约数量</a></li><li class="sidebar-sub-header"><a href="/#批量查询展品授权" class="sidebar-link">批量查询展品授权</a></li><li class="sidebar-sub-header"><a href="/#批量查询展品是否可用-即能否提供给用户签约" class="sidebar-link">批量查询展品是否可用（即能否提供给用户签约）</a></li><li class="sidebar-sub-header"><a href="/#授权错误返回值" class="sidebar-link">授权错误返回值</a></li><li class="sidebar-sub-header"><a href="/#授权处理" class="sidebar-link">授权处理</a></li></ul></li><li><a href="/#用户相关" class="sidebar-link">用户相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#唤起登录" class="sidebar-link">唤起登录</a></li><li class="sidebar-sub-header"><a href="/#唤起退出登录" class="sidebar-link">唤起退出登录</a></li><li class="sidebar-sub-header"><a href="/#获取当前登录用户信息" class="sidebar-link">获取当前登录用户信息</a></li><li class="sidebar-sub-header"><a href="/#监听用户登录事件" class="sidebar-link">监听用户登录事件</a></li><li class="sidebar-sub-header"><a href="/#监听用户在其余页面切换账号或登录事件" class="sidebar-link">监听用户在其余页面切换账号或登录事件</a></li><li class="sidebar-sub-header"><a href="/#用户数据" class="sidebar-link">用户数据</a></li></ul></li><li><a href="/#打包上传" class="sidebar-link">打包上传</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="指南"><a href="#指南" class="header-anchor">#</a> 指南</h1> <h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <h3 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h3> <p>在 Freelog 平台，插件是指作品类型为插件的功能性作品，一般作为主题的依赖在节点发挥作用，决定节点中内容型展品的访问、展示和交互方式。</p> <p>插件可以是一个播放器、一个图床、一个目录菜单或者一个小说阅读器。</p> <h3 id="通俗解释"><a href="#通俗解释" class="header-anchor">#</a> 通俗解释</h3> <p><strong>插件是一个运行在我司平台运行时的可管控的一个完整应用或组件</strong></p> <p><strong>后面出现的运行时皆指平台运行时</strong></p> <h3 id="运行原理"><a href="#运行原理" class="header-anchor">#</a> 运行原理</h3> <p><strong>本平台使用腾讯无界微前端框架</strong> <a href="https://wujie-micro.github.io/doc/guide/" target="_blank" rel="noopener noreferrer">https://wujie-micro.github.io/doc/guide/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="示例节点代码仓"><a href="#示例节点代码仓" class="header-anchor">#</a> 示例节点代码仓</h2> <p><a href="https://github.com/freelogfe/freelog-sample-themes.git" target="_blank" rel="noopener noreferrer">https://github.com/freelogfe/freelog-sample-themes.git<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="基础使用案例代码仓"><a href="#基础使用案例代码仓" class="header-anchor">#</a> 基础使用案例代码仓</h2> <p><a href="https://github.com/freelogfe/freelog-developer-guide-examples.git" target="_blank" rel="noopener noreferrer">https://github.com/freelogfe/freelog-developer-guide-examples.git<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="有意思的怀旧红白机"><a href="#有意思的怀旧红白机" class="header-anchor">#</a> 有意思的怀旧红白机</h3> <p><a href="https://nes-game.freelog.com" target="_blank" rel="noopener noreferrer">https://nes-game.freelog.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="插件改造"><a href="#插件改造" class="header-anchor">#</a> 插件改造</h3> <p><strong>参考下面链接</strong> <a href="https://wujie-micro.github.io/doc/guide/start.html" target="_blank" rel="noopener noreferrer">https://wujie-micro.github.io/doc/guide/start.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="开发"><a href="#开发" class="header-anchor">#</a> 开发</h2> <h3 id="https-证书准备-必须"><a href="#https-证书准备-必须" class="header-anchor">#</a> https 证书准备（必须）</h3> <p><strong>由于浏览器安全限制，本地开发需要本地以 https 启动</strong></p> <p>参考 webpack-mkcert 工具</p> <p><a href="https://www.npmjs.com/package/webpack-mkcert" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/webpack-mkcert<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="chrome-无法访问-localhost-问题"><a href="#chrome-无法访问-localhost-问题" class="header-anchor">#</a> chrome 无法访问 localhost 问题</h3> <p>地址栏输入：chrome://flags/#block-insecure-private-network-requests</p> <p>把 Block insecure private network requests. 设置为 disabled</p> <p>如图
<img src="/chrome.png" alt="chrome"></p> <h3 id="创建一个节点和主题"><a href="#创建一个节点和主题" class="header-anchor">#</a> 创建一个节点和主题</h3> <p>进入 console.freelog.com ---&gt; 节点管理</p> <p>创建节点后必须建一个主题作品并签约激活</p> <p>假设节点为https://examples.freelog.com/</p> <p>用于开发的测试节点为https://t.examples.freelog.com/</p> <h3 id="连接节点与插件"><a href="#连接节点与插件" class="header-anchor">#</a> 连接节点与插件</h3> <p>启动插件，例如‘https://localhost:7101’</p> <p>在节点 url 的https://t.examples.freelog.com/后面加上</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token string">&quot;https://t.examples.freelog.com/?dev=https://localhost:7101&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>此时插件是作为节点主题（即入口）使用</p> <h3 id="安装-api-库"><a href="#安装-api-库" class="header-anchor">#</a> 安装 api 库</h3> <div class="language-js extra-class"><pre class="language-js"><code> npm install freelog<span class="token operator">-</span>runtime
 <span class="token comment">// 使用前导入</span>
 <span class="token keyword">import</span> <span class="token punctuation">{</span> freelogApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;freelog-runtime&quot;</span>
</code></pre></div><h3 id="获取节点信息"><a href="#获取节点信息" class="header-anchor">#</a> 获取节点信息</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> freelogApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;freelog-runtime&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 目前没有权限控制，主题和插件都可以获取到，后期整体考虑权限时会限制插件使用</span>
<span class="token comment">// 如果使用到了节点信息，插件开发者应当在使用说明里明确使用到了节点信息以及无法获取到的影响</span>
<span class="token keyword">const</span> nodeInfo <span class="token operator">=</span> freelogApp<span class="token punctuation">.</span>nodeInfo<span class="token punctuation">;</span>
</code></pre></div><h3 id="加载自身的子依赖插件"><a href="#加载自身的子依赖插件" class="header-anchor">#</a> 加载自身的子依赖插件</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> freelogApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;freelog-runtime&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> subData <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getSubDep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 示范代码，这里只加载一个</span>
subData<span class="token punctuation">.</span>subDep<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sub<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> widgetController <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">mountWidget</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    widget<span class="token operator">:</span> sub<span class="token punctuation">,</span> <span class="token comment">// 必传，子插件数据</span>
    container<span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;freelog-single&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 必传，自定义一个让插件挂载的div容器</span>
    topExhibitData<span class="token operator">:</span> subData<span class="token punctuation">,</span> <span class="token comment">// 必传，最外层展品数据（子孙插件都需要用）</span>
    setupOnly<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 默认false, 当为true时使用wujie的setupApp，之后通过freelogApp.preloadWidget(widgetId)预加载</span>
    wujieConfig<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 配置将合并到startApp或setupApp的配置项中</span>
    config<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 子插件配置数据, 子插件可以通过freelogApp.getSelfConfig()获取配置数据</span>
    seq<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token comment">// 如果要用多个同样的子插件需要传递序号，可以考虑与其余节点插件避免相同的序号, 注意用户数据是根据插件id+序号保存的。</span>
    widget_entry<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token comment">// 本地url，dev模式下，可以使用本地url调试子插件</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="加载展品插件"><a href="#加载展品插件" class="header-anchor">#</a> 加载展品插件</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> freelogApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;freelog-runtime&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitListById</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  articleResourceTypes<span class="token operator">:</span> <span class="token string">&quot;widget&quot;</span><span class="token punctuation">,</span>
  isLoadVersionProperty<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> widgets <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>dataList<span class="token punctuation">;</span>
<span class="token comment">// 示范代码，这里只加载一个</span>
widgets<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>widget<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">// mountWidget最终使用wujie的startApp或setupApp</span>
  <span class="token keyword">let</span> widgetController <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">mountWidget</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    widget<span class="token operator">:</span> widget<span class="token punctuation">,</span>
    container<span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;freelog-single&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 给每一个提供不同的容器</span>
    topExhibitData<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    config<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    setupOnly<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 默认false, 当为true时使用wujie的setupApp，之后通过freelogApp.preloadWidget(widgetId)预加载</span>
    wujieConfig<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 配置将合并到startApp或setupApp的配置项中</span>
    seq<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    widget_entry<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="单独调试某个插件"><a href="#单独调试某个插件" class="header-anchor">#</a> 单独调试某个插件</h3> <p>当需要跳过主题直接调试正在运行的子插件或展品插件</p> <p>定义： <code>${url}?dev=replace&amp;${widgetId}=${local_entry}</code></p> <p>url: 节点地址</p> <p>widgetId: 插件 ID 这里用的是插件的作品 ID: articleId
获取方式：插件内可以通过 freelogApp.getSelfWidgetId()获取，但先有鸡才能有蛋，后续要在作品管理页面以及测试节点提供获取途径。
目前开发者可以 F12 去找一下。</p> <p>local_entry: 本地地址</p> <p>举例：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>nes<span class="token operator">-</span>common<span class="token punctuation">.</span>freelog<span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token operator">?</span>dev<span class="token operator">=</span>replace<span class="token operator">&amp;</span>62270c5cf670b2002e800193<span class="token operator">=</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">localhost:7107</span><span class="token regex-delimiter">/</span></span>
</code></pre></div><h3 id="插件卸载"><a href="#插件卸载" class="header-anchor">#</a> 插件卸载</h3> <p>当插件挂载的容器在组件内部或与组件同生同灭时，在组件卸载前需要卸载插件，否则再次加载会有问题。</p> <p>vue 案例：<a href="https://github.com/freelogfe/freelog-developer-guide-examples/blob/main/examples/vue3-ts-theme/src/views/widget/WidgetMount.vue" target="_blank" rel="noopener noreferrer">前往示例代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// vue示例</span>
<span class="token function">onBeforeUnmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  freelogApp<span class="token punctuation">.</span><span class="token function">destroyWidget</span><span class="token punctuation">(</span>exhibitWidget<span class="token punctuation">.</span>widgetId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// react示例</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    freelogApp<span class="token punctuation">.</span><span class="token function">destroyWidget</span><span class="token punctuation">(</span>exhibitWidget<span class="token punctuation">.</span>widgetId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="获取插件自身配置数据"><a href="#获取插件自身配置数据" class="header-anchor">#</a> 获取插件自身配置数据</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 父插件的传递过来的config数据也会在这里</span>
<span class="token keyword">const</span> widgetConfig <span class="token operator">=</span> freelogApp<span class="token punctuation">.</span><span class="token function">getSelfConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="移动端适配"><a href="#移动端适配" class="header-anchor">#</a> 移动端适配</h3> <p><strong>除媒体查询外，支持最新的问题最少的最好的 viewport 兼容方案</strong></p> <p><strong>推荐使用 postcss-px-to-viewport 插件, 各框架具体使用方法请百度</strong></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token operator">**</span>viewport修改用法<span class="token operator">**</span>
freelogApp<span class="token punctuation">.</span><span class="token function">setViewport</span><span class="token punctuation">(</span>keys<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span>
keys <span class="token operator">=</span> <span class="token punctuation">{</span>
  width<span class="token operator">:</span> <span class="token string">&quot;device-width&quot;</span><span class="token punctuation">,</span> <span class="token comment">// immutable</span>
  height<span class="token operator">:</span> <span class="token string">&quot;device-height&quot;</span><span class="token punctuation">,</span> <span class="token comment">// not supported in browser</span>
  <span class="token string-property property">&quot;initial-scale&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 0.0-10.0   available for theme</span>
  <span class="token string-property property">&quot;maximum-scale&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 0.0-10.0   available for theme</span>
  <span class="token string-property property">&quot;minimum-scale&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 0.0-10.0   available for theme</span>
  <span class="token string-property property">&quot;user-scalable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;no&quot;</span><span class="token punctuation">,</span> <span class="token comment">// available for theme</span>
  <span class="token string-property property">&quot;viewport-fit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span> <span class="token comment">// not supported in browser</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="展品相关"><a href="#展品相关" class="header-anchor">#</a> 展品相关</h2> <h3 id="获取展品"><a href="#获取展品" class="header-anchor">#</a> 获取展品</h3> <p><strong>分页列表</strong></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitListByPaging</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  skip<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  limit<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a href="/api/#getexhibitlistbypaging">查看 getExhibitListByPaging 详情</a></p> <p><strong>查找展品</strong></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitListById</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>

<span class="token operator">**</span>参数说明<span class="token operator">**</span>
  query<span class="token operator">:</span><span class="token punctuation">{</span>
    exhibitIds<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>  展品ids 多个使用<span class="token string">&quot;,&quot;</span>隔开
    isLoadVersionProperty<span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">1</span><span class="token punctuation">,</span> 可选，是否加载版本信息<span class="token punctuation">,</span>默认<span class="token number">0</span>
  <span class="token punctuation">}</span>
</code></pre></div><p><a href="/api/#getexhibitlistbyid">查看 getExhibitListById 详情</a></p> <h3 id="获取单个展品详情"><a href="#获取单个展品详情" class="header-anchor">#</a> 获取单个展品详情</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span>  freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitInfo</span><span class="token punctuation">(</span>exhibitId<span class="token punctuation">,</span> query<span class="token punctuation">)</span>

<span class="token operator">**</span>参数说明<span class="token operator">**</span>
  exhibitId<span class="token operator">:</span> 展品id，
  query<span class="token operator">:</span><span class="token punctuation">{</span>
      isLoadVersionProperty<span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 是否需要展品版本属性</span>
  <span class="token punctuation">}</span>
</code></pre></div><p><a href="/api/#getexhibitinfo">查看 getExhibitInfo 详情</a></p> <h3 id="获取展品作品"><a href="#获取展品作品" class="header-anchor">#</a> 获取展品作品</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitFileStream</span><span class="token punctuation">(</span>
  exhibitId<span class="token punctuation">,</span>
  options
<span class="token punctuation">)</span>

<span class="token operator">**</span>参数说明<span class="token operator">**</span>
  exhibitId<span class="token operator">:</span> <span class="token comment">// 展品id，</span>
  options<span class="token operator">:</span> <span class="token punctuation">{</span>
    returnUrl<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> <span class="token comment">// 是否只返回url， 例如img标签图片只需要url</span>
    config<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span> <span class="token comment">// axios的config 目前仅支持&quot;onUploadProgress&quot;, &quot;onDownloadProgress&quot;, &quot;responseType&quot;</span>
    subFilePath<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// 漫画中的图片等子文件的路径</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="展品子依赖列表"><a href="#展品子依赖列表" class="header-anchor">#</a> 展品子依赖列表</h3> <p><strong>在 获取展品 与 获取单个展品详情 接口返回数据中</strong></p> <div class="language-ts extra-class"><pre class="language-ts"><code>  <span class="token operator">**</span>如下所示，数组versionInfo<span class="token punctuation">.</span>dependencyTree就是该展品的所有子孙依赖列表<span class="token operator">**</span>
  <span class="token operator">**</span>第一个为自身，通过自身的nid去找出parentNid为该nid的依赖即为直接子依赖<span class="token operator">**</span>
  <span class="token punctuation">{</span>
	<span class="token string-property property">&quot;ret&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;errCode&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;errcode&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token string-property property">&quot;exhibitId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;61b99394c9dacc002e9f5821&quot;</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
		<span class="token string-property property">&quot;versionInfo&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token string-property property">&quot;exhibitId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;61b99394c9dacc002e9f5821&quot;</span><span class="token punctuation">,</span>
			<span class="token string-property property">&quot;exhibitProperty&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token string-property property">&quot;fileSize&quot;</span><span class="token operator">:</span> <span class="token number">6234</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;mime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text/markdown&quot;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token string-property property">&quot;dependencyTree&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
				<span class="token string-property property">&quot;nid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;61b99394c9da&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;articleId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;61b993157841ed002e5c96ca&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;articleName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ZhuC/测试md&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;articleType&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.1.1&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;versionRange&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.1.1&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;resourceType&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;markdown&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;versionId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0d786f5b273bc549454b55ea649569a3&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;deep&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;parentNid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
				<span class="token string-property property">&quot;nid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;9091f75e23fb&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;articleId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;61b9a82f2ae3ac002eb7993a&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;articleName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ZhuC/元宇宙&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;articleType&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.1.0&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;versionRange&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.1.0&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;resourceType&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;video&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;versionId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;85fa350f4d003d0adea1fffc2852891d&quot;</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;deep&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
				<span class="token string-property property">&quot;parentNid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;61b99394c9da&quot;</span>
			<span class="token punctuation">}</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="批量查询展品依赖的作品信息"><a href="#批量查询展品依赖的作品信息" class="header-anchor">#</a> 批量查询展品依赖的作品信息</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitDepInfo</span><span class="token punctuation">(</span>
  exhibitId<span class="token punctuation">,</span>
  articleNids
<span class="token punctuation">)</span>
<span class="token operator">**</span>参数说明<span class="token operator">**</span>
  exhibitId<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">,</span>  自身展品id
  articleNids<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> 链路id
</code></pre></div><h3 id="获取子依赖作品文件"><a href="#获取子依赖作品文件" class="header-anchor">#</a> 获取子依赖作品文件</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitDepFileStream</span><span class="token punctuation">(</span>
  exhibitId<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">,</span>
  parentNid<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  subArticleIdOrName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  returnUrl<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
  config<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">)</span>

<span class="token operator">**</span>参数说明<span class="token operator">**</span>
  exhibitId<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">,</span> <span class="token comment">// 自身展品id</span>
  parentNid<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>    <span class="token comment">// 自身链路id</span>
  subArticleIdOrName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token comment">// 子依赖作品id或名称</span>
  returnUrl<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span> <span class="token comment">// 是否只返回url， 例如img标签图片只需要url</span>
  config<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token comment">// axios的config 目前仅支持&quot;onUploadProgress&quot;, &quot;onDownloadProgress&quot;, &quot;responseType&quot;</span>
</code></pre></div><h3 id="查找展品签约数量"><a href="#查找展品签约数量" class="header-anchor">#</a> 查找展品签约数量</h3> <p><strong>同一个用户的多次签约只计算一次</strong></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitSignCount</span><span class="token punctuation">(</span>
  exhibitIds<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span>

<span class="token operator">**</span>参数说明<span class="token operator">**</span>
  exhibitIds<span class="token operator">:</span> 用英文逗号隔开的展品id
</code></pre></div><h3 id="批量查询展品授权"><a href="#批量查询展品授权" class="header-anchor">#</a> 批量查询展品授权</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitAuthStatus</span><span class="token punctuation">(</span>
  exhibitIds<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span>

<span class="token operator">**</span>参数说明<span class="token operator">**</span>
  exhibitIds<span class="token operator">:</span>  用英文逗号隔开的展品id
</code></pre></div><h3 id="批量查询展品是否可用-即能否提供给用户签约"><a href="#批量查询展品是否可用-即能否提供给用户签约" class="header-anchor">#</a> 批量查询展品是否可用（即能否提供给用户签约）</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitAvailalbe</span><span class="token punctuation">(</span>
  exhibitIds<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span>

<span class="token operator">**</span>参数说明<span class="token operator">**</span>
  exhibitIds<span class="token operator">:</span>  用英文逗号隔开的展品id
</code></pre></div><p><a href="/api/#getexhibitavailalbe">查看 getexhibitavailalbe 详情</a></p> <h3 id="授权错误返回值"><a href="#授权错误返回值" class="header-anchor">#</a> 授权错误返回值</h3> <div class="language-ts extra-class"><pre class="language-ts"><code>  <span class="token operator">**</span>存在但未授权<span class="token operator">**</span>
  <span class="token punctuation">{</span>
    authErrorType<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">// 存在但未授权</span>
    authCode<span class="token operator">:</span> resData<span class="token punctuation">.</span>authCode<span class="token punctuation">,</span>
    exhibitName<span class="token punctuation">,</span>
    exhibitId<span class="token punctuation">,</span>
    articleNid<span class="token punctuation">,</span>
    resourceType<span class="token punctuation">,</span>
    subDep<span class="token punctuation">,</span>
    versionInfo<span class="token operator">:</span> <span class="token punctuation">{</span>exhibitProperty<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>resData<span class="token punctuation">,</span> <span class="token comment">// 原始数据</span>
  <span class="token punctuation">}</span>
  <span class="token operator">**</span>不存在<span class="token operator">**</span>
  <span class="token punctuation">{</span>
    authErrorType<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">// 不存在</span>
    authCode<span class="token operator">:</span> resData<span class="token punctuation">.</span>authCode<span class="token punctuation">,</span>
    exhibitName<span class="token punctuation">,</span>
    exhibitId<span class="token punctuation">,</span>
    articleNid<span class="token punctuation">,</span>
    resourceType<span class="token punctuation">,</span>
    subDep<span class="token punctuation">,</span>
    versionInfo<span class="token operator">:</span> <span class="token punctuation">{</span>exhibitProperty<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>resData<span class="token punctuation">,</span> <span class="token comment">// 原始数据</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="授权处理"><a href="#授权处理" class="header-anchor">#</a> 授权处理</h3> <p><strong>单个呼出授权</strong></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 根据展品id获取展品作品</span>
<span class="token keyword">let</span> ch <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getExhibitFileStream</span><span class="token punctuation">(</span>
  chapters<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>exhibitId
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>ch<span class="token punctuation">.</span>authErrorType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 提交给运行时处理</span>
  <span class="token comment">/**
   * addAuth 参数
      exhibitId: string,
      options?: {
        immediate: boolean  // 是否立即弹出授权窗口
      }
  */</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">addAuth</span><span class="token punctuation">(</span>ch<span class="token punctuation">.</span>data<span class="token punctuation">.</span>exhibitId<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      immediate<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token operator">**</span>res返回值说明<span class="token operator">**</span>
   <span class="token punctuation">{</span>status<span class="token operator">:</span> <span class="token constant">SUCCESS</span><span class="token punctuation">,</span> data<span class="token punctuation">}</span>
   status 枚举判断：
     status <span class="token operator">===</span> freelogApp<span class="token punctuation">.</span>resultType<span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">;</span>  <span class="token comment">// 成功</span>
     status <span class="token operator">===</span> freelogApp<span class="token punctuation">.</span>resultType<span class="token punctuation">.</span><span class="token constant">FAILED</span><span class="token punctuation">;</span>   <span class="token comment">// 失败</span>
     status <span class="token operator">===</span> freelogApp<span class="token punctuation">.</span>resultType<span class="token punctuation">.</span><span class="token constant">USER_CANCEL</span><span class="token punctuation">;</span> <span class="token comment">// 用户取消</span>
     status <span class="token operator">===</span> freelogApp<span class="token punctuation">.</span>resultType<span class="token punctuation">.</span><span class="token constant">DATA_ERROR</span><span class="token punctuation">;</span>  <span class="token comment">// 数据错误</span>
     status <span class="token operator">===</span> <span class="token operator">=</span> freelogApp<span class="token punctuation">.</span>resultType<span class="token punctuation">.</span><span class="token constant">OFFLINE</span><span class="token punctuation">;</span> <span class="token comment">// 展品已经下线</span>
   data<span class="token operator">:</span> 如果是<span class="token constant">DATA_ERROR</span>或<span class="token constant">OFFLINE</span>，会返回错误数据或展品数据
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>呼出授权</strong></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 当addAuth多个未授权展品且没有立刻呼出（或者存在未授权展品且已经addAuth 但用户关闭了，插件想要用户签约时）可以通过callAuth()唤出</span>
freelogApp<span class="token punctuation">.</span><span class="token function">callAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="用户相关"><a href="#用户相关" class="header-anchor">#</a> 用户相关</h2> <h3 id="唤起登录"><a href="#唤起登录" class="header-anchor">#</a> 唤起登录</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// callback: 登录成功的回调，登录失败不会回调,这里需要考虑一下，</span>
freelogApp<span class="token punctuation">.</span><span class="token function">callLogin</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="唤起退出登录"><a href="#唤起退出登录" class="header-anchor">#</a> 唤起退出登录</h3> <div class="language-ts extra-class"><pre class="language-ts"><code>freelogApp<span class="token punctuation">.</span><span class="token function">callLoginOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="获取当前登录用户信息"><a href="#获取当前登录用户信息" class="header-anchor">#</a> 获取当前登录用户信息</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="监听用户登录事件"><a href="#监听用户登录事件" class="header-anchor">#</a> 监听用户登录事件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// callback: 登录成功的回调，登录失败不会回调</span>
freelogApp<span class="token punctuation">.</span><span class="token function">onLogin</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="监听用户在其余页面切换账号或登录事件"><a href="#监听用户在其余页面切换账号或登录事件" class="header-anchor">#</a> 监听用户在其余页面切换账号或登录事件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// callback: 再次进入页面发现账号变化后会回调所有函数</span>
freelogApp<span class="token punctuation">.</span><span class="token function">onUserChange</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="用户数据"><a href="#用户数据" class="header-anchor">#</a> 用户数据</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 本地开发时： 如果本地开发的与线上主题或插件不是同一个资源，可以通过在入口文件加载页面加上主题或插件本身的作品名称,
 * 例如：window.FREELOG_RESOURCENAME = &quot;Freelog/dev-docs&quot;;
 * 这样可以保证更换到线上是一致的
 */</span>

<span class="token comment">// 更新用户数据   data 为任意对象，</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">setUserData</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取用户数据</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> freelogApp<span class="token punctuation">.</span><span class="token function">getUserData</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="打包上传"><a href="#打包上传" class="header-anchor">#</a> 打包上传</h2> <p><strong>正常 build 后，将打包后的所有文件压缩为一个 zip 文件（无根目录），作为主题 theme 或插件 widget 类型上传为作品</strong></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ee00aa5c.js" defer></script><script src="/assets/js/2.733019b2.js" defer></script><script src="/assets/js/7.49352607.js" defer></script>
  </body>
</html>
